% Illustrate 3D transform by matrix, AJR Nov 2014
\def\unithouseviews{33,29}%default stereo---now x-eyed
\def\unithouseo{0.3}
\def\unithouselabels%
{xlabel={$x_1$},ylabel={$x_2$},zlabel={$x_3$},label shift={-2ex}}

\newcommand{\ThreeD}[9]{\mbox{% 
\foreach \z in \unithouseviews {% stereo pair in 3D
\begin{tikzpicture}
\begin{axis}[ view={\z}{30},\unithouselabels
  ,axis equal image ,no marks %,grid
  ,height=5cm, \unithousesize
  ] 
\addplot3+[thick] coordinates {(0,0,0)(1,0,0)
  (1,0.4,0)(1,0.4,0.6)(1,0.7,0.6)(1,0.7,0)% doorway
  (1,1,0)(0,1,0)(0,0,0)(0,0,1)(1,0,1)(0.5,0.5,1.2)
  (0,0,1)(0,1,1)(0.5,0.5,1.2)(1,1,1)(0,1,1)
  (0,1,0)(1,1,0)(1,1,1)(1,0,1)(1,0,0)
  }; 
%\addlegendentry{unit house};
\addplot3+[thick] coordinates {(0,0,0) (#1,#4,#7)
  (#1+0.4*#2,#4+0.4*#5,#7+0.4*#8)
  (#1+0.4*#2+0.6*#3,#4+0.4*#5+0.6*#6,#7+0.4*#8+0.6*#9)
  (#1+0.7*#2+0.6*#3,#4+0.7*#5+0.6*#6,#7+0.7*#8+0.6*#9)
  (#1+0.7*#2,#4+0.7*#5,#7+0.7*#8)% doorway
  (#1+#2,#4+#5,#7+#8)
  (#2,#5,#8) (0,0,0) (#3,#6,#9) (#1+#3,#4+#6,#7+#9)
  (0.5*#1+0.5*#2+1.2*#3,0.5*#4+0.5*#5+1.2*#6,0.5*#7+0.5*#8+1.2*#9)
  (#3,#6,#9)  (#2+#3,#5+#6,#8+#9) 
  (0.5*#1+0.5*#2+1.2*#3,0.5*#4+0.5*#5+1.2*#6,0.5*#7+0.5*#8+1.2*#9)
  (#1+#2+#3,#4+#5+#6,#7+#8+#9) (#2+#3,#5+#6,#8+#9)
  (#2,#5,#8) (#1+#2,#4+#5,#7+#8) (#1+#2+#3,#4+#5+#6,#7+#8+#9)
  (#1+#3,#4+#6,#7+#9) (#1,#4,#7)
  }; 
%\addlegendentry{transform};
% Add shaded facets to each side of the transform:
% does not do much as just see two sides of cube everywhere.
\addplot3[patch,opacity=\unithouseo,shader=interp] coordinates {
(0,0,0) (#1,#4,#7) (#1+#2,#4+#5,#7+#8)    
(0,0,0) (#2,#5,#8) (#1+#2,#4+#5,#7+#8)    
(0,0,0) (#1,#4,#7) (#1+#3,#4+#6,#7+#9)    
(0,0,0) (#3,#6,#9) (#1+#3,#4+#6,#7+#9)    
(0,0,0) (#2,#5,#8) (#3+#2,#6+#5,#9+#8)    
(0,0,0) (#3,#6,#9) (#2+#3,#5+#6,#8+#9) 
(#1+#2+#3,#4+#5+#6,#7+#8+#9) (#2+#3,#5+#6,#8+#9) (#3,#6,#9)    
(#1+#2+#3,#4+#5+#6,#7+#8+#9) (#1+#3,#4+#6,#7+#9) (#3,#6,#9)    
(#1+#2+#3,#4+#5+#6,#7+#8+#9) (#2+#3,#5+#6,#8+#9) (#2,#5,#8)    
(#1+#2+#3,#4+#5+#6,#7+#8+#9) (#1+#2,#4+#5,#7+#8) (#2,#5,#8)    
(#1+#2+#3,#4+#5+#6,#7+#8+#9) (#1+#3,#4+#6,#7+#9) (#1,#4,#7)    
(#1+#2+#3,#4+#5+#6,#7+#8+#9) (#1+#2,#4+#5,#7+#8) (#1,#4,#7)    
};
\end{axis}
\end{tikzpicture}
}}}
%\ThreeD{1/3}{-2/3}{-2/3}
%{2/3}{-1/3}{+2/3}
%{2/3}{+2/3}{-1/3}



\newcommand{\ThreeDgen}[1]{\mbox{% 
\foreach \z in \unithouseviews {% stereo pair in 3D
\begin{tikzpicture}
\begin{axis}[ view={\z}{30},\unithouselabels
  ,axis equal image ,no marks %,grid
  ,height=5cm ,\unithousesize
  ] 
\addplot3+[thick] table[row sep=\\] {
   0.00   0.00   0.00 \\
   1.00   0.00   0.00 \\
   1.00   0.40   0.00 \\
   1.00   0.40   0.60 \\
   1.00   0.70   0.60 \\
   1.00   0.70   0.00 \\
   1.00   1.00   0.00 \\
   0.00   1.00   0.00 \\
   0.00   0.00   0.00 \\
   0.00   0.00   1.00 \\
   1.00   0.00   1.00 \\
   0.50   0.50   1.20 \\
   0.00   0.00   1.00 \\
   0.00   1.00   1.00 \\
   0.50   0.50   1.20 \\
   1.00   1.00   1.00 \\
   0.00   1.00   1.00 \\
   0.00   1.00   0.00 \\
   1.00   1.00   0.00 \\
   1.00   1.00   1.00 \\
   1.00   0.00   1.00 \\
   1.00   0.00   0.00 \\
  }; 
\addplot3+[thick] table[row sep=\\] {#1}; 
\end{axis}
\end{tikzpicture}
}}%end stereo pair
}% end new command

